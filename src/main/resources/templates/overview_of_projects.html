<!DOCTYPE html>
<html lang="da" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Projektoversigt</title>
  <link rel="stylesheet" th:href="@{/css/generic_styles.css}">
  <link rel="stylesheet" th:href="@{/css/dashboard_specific.css}">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&family=Montserrat+Alternates:wght@900&display=swap" rel="stylesheet">
</head>
<body>
<div class="main-container">
  <div class="modal-container dashboard-container">
    <!-- Header -->
    <h1 class="modal-title">Projektoversigt</h1>
    <p class="modal-subtitle">Her kan du se alle dine projekter med nøgleinformation.</p>

    <!-- Søgefunktion og filter -->
    <form th:action="@{/project/filter}" method="get" class="filter-container">
      <div class="form-group search-group">
        <input type="text" id="projectSearch" name="search" placeholder="Søg efter projektnavn...">
      </div>
      <div class="form-group filter-group">
        <select id="statusFilter" name="status">
          <option value="">Alle statusser</option>                  <!-- Displays all statuses because none is selected -->
          <option th:each="status : ${stateStatuses}"               <!-- Iterates over all statuses -->
          th:value="${status}"                                      <!-- Enum value sent to the server, for example, NOT_STARTED -->
          th:text="${status}"                                       <!-- Enum value displayed to the user, for example, Ikke startet -->
          th:selected="${param.status == status.name()}"></option>  <!-- Selects the appropriate status based on the selected status in the URL, accessed via param. -->
        </select>

      </div>
      <button type="submit" class="filter-button">Filtrer</button>
    </form>

    <!-- Projekttabel -->
    <div class="table-container">
      <table class="project-table">

        <thead>
        <tr>
          <th>Projektnavn</th>
          <th>Status</th>
          <th>Færdiggørelse</th>
          <th>Handlinger</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="project : ${projects}"> <!-- Iterates over the list of projects -->
          <td th:text="${project.name}"></td>

          <td>
            <!-- th:classappend appends a CSS class based on the status, allowing unique styling for each status -->
            <span class="status-badge"
                    th:classappend="${'status-' + project.status.toString().toLowerCase()}"
                    th:text="${project.status}"></span>
          </td>

          <td>
            <div class="progress-container">
              <div class="progress-bar"
                   th:style="'width:' + ${project.completionPercentage} + '%'"></div>  <!-- Dynamic styling with Thymeleaf of the width of an element based on a variable input -->
              <span class="progress-text" th:text="${project.completionPercentage} + '%'"></span>
            </div>
          </td>

          <td>
            <a th:href="@{/project/details/{id}(id=${project.projectId})}" class="secondary-button">Se detaljer</a>
          </td>

        </tr>
        <!-- Hvis der ikke er nogen projekter -->
        <tr th:if="${projects.empty}">
          <td colspan="4" class="text-center">Ingen projekter fundet</td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- Opret nyt projekt knap -->
    <div class="form-group">
      <a th:href="@{/project/create}" class="action-button">Opret nyt projekt</a>
    </div>
  </div>
</div>
</body>
</html>